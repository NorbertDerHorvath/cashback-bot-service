<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 20px; background: #f4f4f9; }
        .status-card { background: white; padding: 15px; border-radius: 10px; display: inline-block; box-shadow: 0 2px 5px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .dot { height: 12px; width: 12px; background-color: #bbb; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .online { background-color: #4CAF50; box-shadow: 0 0 8px #4CAF50; }
        button { padding: 15px 30px; font-size: 18px; cursor: pointer; background: #ff4444; color: white; border: none; border-radius: 5px; }
        button:active { background: #cc0000; }
    </style>
</head>
<body>

    <div class="status-card">
        <span id="status-dot" class="dot"></span>
        <strong>Bot √Ållapot:</strong> <span id="last-ping">Bet√∂lt√©s...</span>
    </div>

    <br>

    <button onclick="triggerReset()">üî¥ ADATB√ÅZIS RESET √âS √öJ KERES√âS</button>

    <script>
        const firebaseConfig = {
            databaseURL: "https://coupons-79d9f-default-rtdb.europe-west1.firebasedatabase.app/"
        };
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // √âletjel figyel√©se
        database.ref('system/keep_alive_ping').on('value', (snapshot) => {
            const timestamp = snapshot.val();
            if (timestamp) {
                const date = new Date(timestamp * 1000);
                document.getElementById('last-ping').innerText = date.toLocaleTimeString('hu-HU');
                
                // Ha az utols√≥ ping 15 percn√©l frissebb, z√∂ld a l√°mpa
                const now = Math.floor(Date.now() / 1000);
                if (now - timestamp < 900) {
                    document.getElementById('status-dot').className = "dot online";
                } else {
                    document.getElementById('status-dot').className = "dot";
                }
            }
        });

        function triggerReset() {
            if(confirm("Biztosan t√∂rl√∂d az √∂sszes kupont √©s √∫j keres√©st ind√≠tasz?")) {
                database.ref('commands/full_scan').set({
                    processed: false,
                    timestamp: Date.now()
                }).then(() => {
                    alert("Parancs elk√ºldve a botnak!");
                });
            }
        }
    </script>
</body>
</html>
